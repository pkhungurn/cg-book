<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/theme.css" rel="stylesheet">
  <!-- MathJax -->
  <script type="text/javascript">
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <script type="text/javascript" id="MathJax-script" src="../mathjax/tex-mml-chtml.js"></script>
  <link rel="stylesheet"
      href="../highlight/styles/default.min.css">
  <script src="../highlight/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
    
  <title>Chapter 6</title>
</head>

<body>
  <div class="container" style="max-width: 640px;">
    <span style="visibility: hidden;">
      \(
      \def\sc#1{\dosc#1\csod}
      \def\dosc#1#2\csod{{\rm #1{\small #2}}}

      \newcommand{\dee}{\mathrm{d}}
      \newcommand{\Dee}{\mathrm{D}}
      \newcommand{\In}{\mathrm{in}}
      \newcommand{\Out}{\mathrm{out}}
      \newcommand{\pdf}{\mathrm{pdf}}
      \newcommand{\Cov}{\mathrm{Cov}}
      \newcommand{\Var}{\mathrm{Var}}

      \newcommand{\ve}[1]{\mathbf{#1}}
      \newcommand{\mrm}[1]{\mathrm{#1}}
      \newcommand{\ves}[1]{\boldsymbol{#1}}
      \newcommand{\etal}{{et~al.}}
      \newcommand{\sphere}{\mathbb{S}^2}
      \newcommand{\modeint}{\mathcal{M}}
      \newcommand{\azimint}{\mathcal{N}}
      \newcommand{\ra}{\rightarrow}
      \newcommand{\mcal}[1]{\mathcal{#1}}
      \newcommand{\X}{\mathcal{X}}
      \newcommand{\Y}{\mathcal{Y}}
      \newcommand{\Z}{\mathcal{Z}}
      \newcommand{\x}{\mathbf{x}}
      \newcommand{\y}{\mathbf{y}}
      \newcommand{\z}{\mathbf{z}}
      \newcommand{\tr}{\mathrm{tr}}
      \newcommand{\sgn}{\mathrm{sgn}}
      \newcommand{\diag}{\mathrm{diag}}
      \newcommand{\Real}{\mathbb{R}}
      \newcommand{\sseq}{\subseteq}
      \newcommand{\ov}[1]{\overline{#1}}
      \DeclareMathOperator*{\argmax}{arg\,max}
      \DeclareMathOperator*{\argmin}{arg\,min}
      \)
    </span>

    <h1>6 &nbsp; Normal vectors</h1>
    <hr>

    <p>We learned in the last chapter that we model shapes of objects by modeling their external surfaces. <b>Normal vectors</b> are common properties of surfaces that must be taken to account when creating any surface models.</p>

    <p>We have seen the term "normal vector" before in Section 3.7.5. A normal vector to a plane is a vector that is perpendicular to it. A normal vector to a surface is a vector that is "perpendicular" to that surface in some sense. However, we have to be careful about its definition because a general surface is not completely flat like a plane, and so we cannot conveniently measure the angle between a vector and a surface to decide whether they are perpedicular to each other or not. (There is a way to extend the definition, of course!)</p>

    <p>We care about normal vectors because they tell us about the "directions" of the surface. These directions can be used to perform (1) hidden surface removal (Chapter XXX) and (2) shading (Chapter XXX). Shading is largely about calculating how light interacts with a surface, and this interaction depends on the surface's geometry. The surface's directions, conveyed by normal vectors, are geometric information that plays a central role in lighting calculation.</p>

    <p>Now, the confusing thing about normal vectors, at least in the field of computer graphics, is that there are multiple kinds of them. The normal vector we just talked about is called the <b>surface normal vector.</b> When we model shapes with triangle meshes, we deal with two more types: <b>face normal vector</b> and <b>vertex normal vector.</b> Let us now discuss them in turn.</p>

    <h2>6.1 &nbsp; Surface normal vectors</h2>

    <h3>6.1.1 &nbsp; Normal vectors to a flat surface</h3>

    <p>A flat surface is a surface such that there is a 2D plane that contains it. Recall from Section 3.7.5 that a 2D plane in 3D space can be defined by (1) a point on the plane and (2) a vector called the "normal vector." The normal vector has the property that it is perpendicular to the plane, meaning that it is perpendicular to any vectors that is in that plane. Now, if a vector is perpendicalar to a plane, it is also perpendicular to any flat surface contained in that plane. So, we say that a normal vector to the plane is also a normal vector to the flat surface as well.</p>

    <p>Let $\ve{n}$ be a normal vector to a flat surface. We know that it is not the only normal vector because because $2\ve{n}$, $3.14\ve{n}$, $-\ve{n}$, or any $c\ve{n}$ where $c \neq 0$ is also perpendicular to the flat surface.</p>

    <figure class="figure">
        <a href="images/flat-surface-normals.png"><img src="images/flat-surface-normals.png" width="300" alt=""></a>
        <br>
        <figcaption class="figure-caption"><strong>Figure 6.1</strong> A flat surface (represented by the blue rectangle) inside a plane (represented by gray dashed lines) has many normal vectors. Each vector points either upward or downward, but there is no restriction on its length.</figcaption>
    </figure>

    <p>To avoid ambiguity about the length of normal vectors, we often require that normal vectors be unit vectors. In other words, we prefer only to talk about $\ve{n}$ such that $\ve{n} = 1$. With this restriction, we have that a flat surface has two distinct (unit) normal vectors, and they point in the exact opposite direction.</p>

    <figure class="figure">
        <a href="images/flat-surface-unit-normals.png"><img src="images/flat-surface-unit-normals.png" width="300" alt=""></a>
        <br>
        <figcaption class="figure-caption"><strong>Figure 6.2</strong> By restrict ourselves to only consider normals vectors that have unit length, we have that a flat surface has two distinct normal vectors. They point in the exact opposite directions.</figcaption>
    </figure>

    <h3>6.1.2 &nbsp; Orientation of a flat surface and "the" normal vector</h3>

    <p>The fact that there are two distinct normal vectors to a flat surface corresponds to the fact that surface has two sides. Now, we may choose to call one side the "front" side and the other the "back" side. This choice is arbitrary. After we have picked the side to call "front," we have decided the flat surface's <b>orientation</b>. In effect, we have chosen the way the flat surface is "facing." Picking the side to call "front" is equivalent to pick one of the two normal vectors to serve as "the" (one and only one) normal vector of the surface over the other. <b>In this book, the normal vector is on the front side</b>. In other words, the front side is the side we see when we look in the opposite direction of the normal vector. As a result, <b>the choise of the normal vector reflects the orientation of a flat surface</b>.</p>

    <figure class="figure">
        <table>
            <tr>
                <td><a href="images/flat-surface-two-sides.png"><img src="images/flat-surface-two-sides.png" alt=""></a></td>
                <td>&nbsp;</td>
                <td><a href="images/flat-surface-after-normal-picked.png"><img src="images/flat-surface-after-normal-picked.png" alt=""></a></td>
            </tr>
            <tr>
                <td align="center">(a)</td>
                <td>&nbsp;</td>
                <td align="center">(b)</td>
            </tr>
        </table>
        <br>
        <figcaption class="figure-caption"><strong>Figure 6.3</strong> (a) We take a side view of the flat surface in Figure 5.9. We see that the surface has two sides, agreeing with the face that it has two distinct (unit) normal vectors. (b) We can pick a side we call the "front" side. This is equivalent to picking one of the two normal vectors to serve as "the" normal vector of the surface. In this book, the normal vector always points away from the front side.</figcaption>
    </figure>
    
    <p>So, from now on, the normal vector of a flat surface is the unit vetor that:</p>

    <ol>
        <li>is perpendicular to the surface, and</li>
        <li>points away from the side we consider to be the front side.</li>
    </ol>

    <p>Let us stress that the normal vector to a flat surface is perpendicular to that surface as a whole. This means that we can place the normal vector anywhere on the surface, and the normal would be perpendicular to the surface at that point.</p>

    <h3>6.1.3 &nbsp; Regular surfaces</h3>

    <p>Curved surfaces such as spheres, ellepsoids, torii are used by artists approximate shapes of 3D objects. These surfaces belong to a class of surfaces called <b>regular surface</b> where the notion of normal vectors are well defined.</p>

    <figure class="figure">      
      <a href="images/regular-surfaces.png"><img src="images/regular-surfaces.png" width="600" alt=""></a>
      <br>      
      <figcaption class="figure-caption"><strong>Figure 6.4</strong> A sphere, an ellipsoid, and a torus are examples of regular surfaces.</figcaption>
  </figure>

    <p>Intuitively, regular surfaces are surfaces that are "locally flat." This means that, when you pick a point on the surface and zoom in on it close enough, the surface in your vision should look flat. Another way to think about this is to imagine the surface to be very big and yourself to be a small creature standing on it. If the surface is a manifold, then it looks like you are standing on a flat plane. In fact, we all have this experience. The earth is round (i.e., its shape can be approximated quite well by a sphere or an ellipsoid), but we can hardly observe its curvature while standing at sea level. It took a long time for humanity to realize that the earth is not flat! (Sadly, some people believe it is even now.)</p>

    <p>We will not, however, define the regular surface mathematically because doing so requires much mathematical machinery that we will not use again in the rest of the book.<sup><a href="#fn:regular-surface-definition">1</a></sup></p>

    <h3>6.1.4 &nbsp; Tangent planes and surface normal vectors</h3>

    <p>A regular surface has a property that allows it to have normal vectors. Each point $P$ of the surface has a plane called the "tangent plane" that "touches" the surface at $P$. For other types of surfaces, the existence of tangent planes are not gauranteed.</p>

    <p>Formally, a <b>secant plane</b> to a surface is a plane that passes through three points of the surface. Let $P$ be a point on a surface $S$. We can force the three points to be closer and closer to $P$. Taking the limit of this process, the secant plane may approach a unique plane that contains $P$. This plane, if it exists, is called the <b>tangent plane at $P$</b>. It is the plane that best approximates the surface around $P$ among all the other planes. For a regular surface, a tangent plane exists for every point. As a result, a regular surface appears locally flat because the surface can be approximated locally by tangent planes.</p>

    <figure class="figure">      
      <table>
        <tr>
          <td>
            <a href="images/secant-plane.png"><img src="images/secant-plane.png" width="300" alt=""></a>
          </td>
          <td>&nbsp;</td>
          <td>
            <a href="images/tangent-plane.png"><img src="images/tangent-plane.png" width="300" alt=""></a>
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td></td>
          <td align="center">(b)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.5</strong> (a) A secant plane is a plane that passes through three points on a surface. (A plane is infinitely wide, but we show only a part of it for clarity.) (b) A tangent plane is the limit of the secant plane when the three points are forced to approach a single point. In this case, the point is the north pole of the sphere. The tangent plane "touches" the sphere at that point.</figcaption>
  </figure>

    <p>We say that a vector $\ve{v}$ is <b>tangent</b> to a surface $S$ at point $P$ if $\ve{v}$ lies in the tangent plane at $P$. We call such a vector $\ve{v}$ a <b>tangent vector</b>.</p>

    <p>We say that a vector $\ve{n}$ is <b>normal</b> to a surface $S$ at point $P$ if the vector is perpendicular to the tangent plane at $P$. Such a vector is called a <b>normal vector</b> or a <b>surface normal vector</b> of $S$.</p>

    <figure class="figure">      
      <table>
        <tr>
          <td>
            <a href="images/tangent-vectors.png"><img src="images/tangent-vectors.png" width="300" alt=""></a>
          </td>
          <td>&nbsp;</td>
          <td>
            <a href="images/surface-normal-vectors.png"><img src="images/surface-normal-vectors.png" width="300" alt=""></a>
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td></td>
          <td align="center">(b)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.6</strong> Tangent vectors and normal vectors are defined in terms of the tangent plane. Here, we consider the tangent plane at the north pole of the pink sphere. Examples of tangent vectors are shown in (a), and examples of normal vectors are shown in (b).</figcaption>
  </figure>

    <p>If $S$ is a regular surface, then every point on it has a tangent plane and, consequentially, (infinitely many) normal vectors. Following the discussion in Section 6.1.1, we typically require that normal vectors be unit vectors. As a result, each point on $S$ has two normal vectors. One points away from the "front" side of the tangent plane, and the other from the "back" side.</p>

    <h3>6.1.6 &nbsp; Examples</h3>

    <p>Let us consider three simple regular surfaces and learn what their normal vectors and tangent planes are.</p>

    <h4>6.1.6.1 &nbsp; Plane</h4>

    <p>It is important to recognize that a plane is a regular surface. The plane is locally flat because it is globally flat. The tangent plane of the plane is the plane itself. The two unit normal vectors at all points are the same ones.</p>

    <h4>6.1.6.2 &nbsp; Infinite Cylinder</h4>

    <p>Let us consider an infinitely long cylinder or radius $r$ whose axis is the $z$-axis. The set of points that constitute the cylinder is given by
    $$ \{ (x,y,z) : x^2 + y^2 = r^2 \}.$$    
    Now, let $P = (p_x, p_y, p_z)$ be a point on the cylinder. It turns out that the vector $\ve{n} = (p_x,p_y,0)$ is a normal vector to the cylinder at $P$. So, the tangent plane at $P$ is given by:
    \begin{align*}
      &\{ (x,y,z) : ((x,y,z) - P) \cdot \ve{n} = 0 \} \\
      &= \{ (x,y,z) : (x-p_x, y-p_y, z-p_x) \cdot (p_x, p_y, 0) = 0 \} \\
      &= \{ (x,y,z) : (x - p_x)p_x + (y - p_y)p_y  = 0 \} \\
      &= \{ (x,y,z) : p_x x + p_y y - p_x^2 - p_y^2 = 0 \} \\ 
      &= \{ (x,y,z) : p_x x + p_y y - r^2 = 0 \}.
    \end{align*}
    The last line follows from the fact that $(p_x,p_y,p_z)$ is a point on the cylinder, so it must be the case that $p_x^2 + p_y^2 = r^2$.
    </p>
    
    <p>We can see a reason why the normal is $(p_x,p_y,0)$ by considering the cylinder's cross section. If we look at the intersection of the cylinder with the plane $z = p_z$, then we would see the cylinder's cross section as a circle of radius 1 whose center is the point $O = (0,0,p_z)$. The vector $(p_x, p_y, 0) = P - O$ is parallel to the line segment $\overline{OP}.$ Moreover, we know from Euclidean geometry that $\overline{OP}$ is perpendicular to the tangent line to the circle at $P$. So, $(p_x, p_y, 0)$ is perpendicular to the tangent line, which is a part of the tangent plane.</p>

    <figure class="figure">
      <table>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/infinite-cylinder.png"><img src="images/infinite-cylinder.png" width="300" alt=""></a>
            </div>            
          </td>
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/infinite-cylinder-normals.png"><img src="images/infinite-cylinder-normals.png" width="300" alt=""></a>
            </div>            
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td></td>
          <td align="center">(b)</td>
        </tr>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/infinite-cylinder-tangent-planes.png"><img src="images/infinite-cylinder-tangent-planes.png" width="300" alt=""></a>
            </div>            
          </td>
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/infinite-cylinder-normal-explanation.png"><img src="images/infinite-cylinder-normal-explanation.png" width="300" alt=""></a>
            </div>            
          </td>
        </tr>
        <tr>
          <td align="center">(c)</td>
          <td></td>
          <td align="center">(d)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.7</strong> (a) The infinite cylinder under discussion. (b) Some normal vectors of the infinite cylinder. Each vector is placed at the point where it is perpendicular to. (c) Some tangent planes of the infinite cylinder. (d) An examplation for why $\ve{n} = (p_x, p_y, 0)$ is a normal vector at $P = (p_x, p_y, p_z)$. We can see that, when looking at the cross section of the cylinder with the plane $z = p_z$, the segment $\overline{OP}$, which is parallel to $\ve{n}$, is perpendicular to the tangent line to the cirlce at $P$.</figcaption>
    </figure>    

    <p>Remember that $(p_x, p_y, 0)$ is but one of the infinitely many normal vectors at $P$. If $r \neq 1$, it is not a unit vector. If we restrict ourselves to talk only about unit normal vectors, then they are
    \begin{align*}
    \frac{\ve{n}}{\| \ve{n} \|} 
    &= \frac{(p_x, p_y, 0)}{\sqrt{ p_x^2 + p_y^2 }}
    = \bigg( \frac{p_x}{r}, \frac{p_y}{r}, 0 \bigg), \\
    -\frac{\ve{n}}{\| \ve{n} \|} 
    &= \bigg( \frac{-p_x}{r}, \frac{-p_y}{r}, 0 \bigg).
    \end{align*}
    </p>

    <h4>6.1.6.3 &nbsp; Sphere</h4>

    <p>Consider the sphere whose radius is $r$ and whose center is the origin is the point $O = (o_x, o_y, o_z)$. The sphere is the set
    \begin{align*}
    \{ (x,y,y) : (x - o_x)^2 + (y - o_y)^2 + (z - o_z)^2 = r^2 \}.
    \end{align*}
    Let $P = (p_x, p_y, p_z)$ be a point on the sphere. The vector $$\ve{n} = P - O = (p_x - o_x, p_y - o_y, p_z - o_z)$$
    is a normal vector to the sphere at $P$. As a result, the tangent plane at $P$ is given by
    \begin{align*}
      &\{ (x,y,z) : ((x,y,z) - P) \cdot \ve{n} = 0 \} \\
      &= \{ (x,y,z) : (x-p_x, y-p_y, z-p_z) \cdot (p_x, p_y, p_z) = 0 \} \\
      &= \{ (x,y,z) : p_x x + p_y y + p_z z - p_x^2 - p_y^2 - p_z^2= 0 \} \\
      &= \{ (x,y,z) : p_x x + p_y y + p_z z - r^2 = 0 \}.
    \end{align*}
    </p>    

    <p>A reason why $\ve{n} = P-O$ is a normal vector at $P$ is quite similar to that of the cylinder's normals. There are infinitely many planes that pass through $O$ and $P$. Picking one, the intersection of the plane and the sphere yields a great circle. Euclidean geometry again tells us that $\overline{OP}$ (and also $\ve{n}$) is perpendicular to the tangent line at $P$, which is a part of the tangent plane.</p>

    <figure class="figure">
      <table>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/sphere-normals.png"><img src="images/sphere-normals.png" width="300" alt=""></a>
            </div>            
          </td>
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/sphere-normals-xray.png"><img src="images/sphere-normals-xray.png" width="300" alt=""></a>
            </div>            
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td></td>
          <td align="center">(b)</td>
        </tr>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/sphere-tangent-planes.png"><img src="images/sphere-tangent-planes.png" width="300" alt=""></a>
            </div>            
          </td>
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/sphere-normal-explanation.png"><img src="images/sphere-normal-explanation.png" width="300" alt=""></a>
            </div>            
          </td>
        </tr>
        <tr>
          <td align="center">(c)</td>
          <td></td>
          <td align="center">(d)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.8</strong> (a) Normal vectors of a sphere at various points on it. (b) The normal vector at each point (black) is parallel to the vector from the center of the sphere to the point (red). (c) Examples of tangent planes to the sphere. (d) An explanation why any normal vector at $P$ must be parallel to the vector from the center of the sphere $O$ to $P$. Here, we see the plane of a great circle containing $P$. We can see that the line tangent to the circle at $P$ is perpendicular to the radius $\overline{OP}$, which is parallel to the vector $P-O$.</figcaption>
    </figure>    

    <h3>6.1.7 &nbsp; Orientation of regular surfaces</h3>

    <p>In Section 6.1.2, we learned that the two unit normal vectors to a plane correspond to the plane's two sides. Moreover, we often pick one unit normal vectors to serve as "the" normal vector of the plane and thereby pick which side of the plane is the front side.</p>

    <p>We can do the same to a regular surface. However, instead of picking only one unit normal vector, we need to pick a unit normal vector at each point on the surface because the tangent planes of different points can be different.</p>

    <p>Because a regular surface contains infinitely many points, there are infinitely many decisions to make and therefore infinitely many ways to assign a unit normal vector to each point on the surface (Figure 6.9a).  Nevertheless, the assignments are not equally good. We generally prefer assignments such that the normal vectors vary continuously across the surface. Such assignments are much easier to understand, and they avoid the problem of normal vectors dramatically switch direction as one move continuously from one point to another on the surface (Figure 6.9b). A consistent way to assign a unit normal vector at each point on the surface such that the normals vary continously is called an <b>orientation</b> of that surface (Figure 6.9c and 6.9d). If such as an assignment exist for a surface, we say that the surface is <b>orientable</b>.</p>

    <figure class="figure">
      <table>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/curved-surface-normals.png"><img src="images/curved-surface-normals.png" width="300" alt=""></a>
            </div>            
          </td>
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/curved-surface-normal-choices.png"><img src="images/curved-surface-normal-choices.png" width="300" alt=""></a>
            </div>            
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td>&nbsp;</td>
          <td align="center">(b)</td>
        </tr>
        <tr>
          <td>
            <div style="border: 1px solid;">
              <a href="images/curved-surface-orientation-0.png"><img src="images/curved-surface-orientation-0.png" width="300" alt=""></a>
            </div>
          </td>   
          <td>&nbsp;</td>
          <td>
            <div style="border: 1px solid;">
              <a href="images/curved-surface-orientation-1.png"><img src="images/curved-surface-orientation-1.png" width="300" alt=""></a>
            </div>
          </td>
        </tr>
        <tr>
          <td align="center">(c)</td>
          <td>&nbsp;</td>
          <td align="center">(d)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.9</strong> (a) Unlike a flat surface, the directions of normal vectors of a curve surface change as we move from one point to another. At each point, there are two candidate unit normal vectors that we can pick as "the" normal vector at each point. (b) Here we show a random way to pick the normal vector at each point. It is not so good because the normals can suddenly flip directions. A way to pick unit normal vectors so that they vary continuously across the surface is called an <i>orientation</i>. An orientation where the normals point outward from the surface is shown in (c), and another where the normals point inward is shown in (d).</figcaption>
    </figure> 

    <p>Regular surfaces that we have discussed so far&mdash;planes, infinite cylinders, spheres, and tori&mdash;are all orientable. A property of orientable surfaces is that they have two sides (Figure 6.10). The sides the normal vectors are on is the front, and the other side is the back.</p>

    <figure class="figure">
      <a href="images/regular-surfaces-have-two-sides.png"><img src="images/regular-surfaces-have-two-sides.png" width="600"></a>
      <figcaption class="figure-caption"><strong>Figure 6.10</strong> Regular surfaces in Figure 6.4 are all orientable. Each surface has two sides, and we show them by cutting open the surface and coloring the sides differently.</figcaption>
    </figure> 

    <p>An interesting fact is that not all surfaces are orientable. The Möbius strip is such a surface. If we pick a normal vector, say $\ve{n}$, for a point $P$, we find a loop on the surface that starts at $P$ and goes back $P$ that also forces us to pick $-\ve{n}$ as the normal vector at $P$ as well. In a sense, the Möbius strip is not orientable because it has only one side. In this book, we will not deal with unorientable surfaces.</p>

    <figure class="figure">
      <a href="images/moebius-strip.jpg"><img src="images/moebius-strip.jpg" width="600"></a>
      <figcaption class="figure-caption"><strong>Figure 6.11</strong> A Möbius strip can be created by taking a flat strip of paper, twist an end by a half full turn, and then glue the ends together. In this way, the front side and the back side of the strip becomes the "same" side, making it impossible to orient the surface.</figcaption>
    </figure> 

    <p>Now, consider an orienable surface that is also closed, like a sphere. The surface splits space into two regions: the inside and the outside. The surface also has two sides: the front and the back. In computer graphics, it is common to require that <b>the front side lies on the outside</b>, or, in other words, the <b>the normal vectors of a closed, orientable surface should point outward</b>. In other words, we prefer the orientation in Figure 6.9c over the one in Figure 6.9d. As a result, for the infinite cylinder in Section 6.1.6.2, we prefer $(p_x/r, p_x/r, 0)$ over $(-p_x/r, -p_x/r, 0)$ as the normal vector because $(p_x/r, p_x/r, 0)$ points outside. For the sphere in Section 6.1.6.3, we prepare $(p_x/r, p_y/r, p_z/r)$ over $(-p_x/r, -p_y/r, -p_z/r)$ for the same reason.</p>

    <p>Before going to the next section, let us take stock. We care about surface normal vectors because they inform us about the surface's geometry: the normal vector at a point on the surface immediately tells us what the tangent plane at that point is, and the tangent plane can be used to approximate the surface near the point. The normal vector also allows us to distinguish between the front and back sides of the surface. The knowledge is used for hidden surface removal (Chapter XXX), and it also allows us to shade the front side and the back side differently (Chapter XXX). Moreover, when the surface is closed, it also tells us which part of space is the inside and which is the outside. This is important for lighting calculation that involves the use of Snell's law (Chapter XXX).</p>
   
    <h2>6.2 &nbsp; Face normal vectors</h2>

    <p>Face normal vectors are surface normal vectors when the surface is a mesh. While the graphics pipeline can only deal with triangle meshes, other 3DCG software (especiallying modeling software such as <a href="https://www.blender.org/">Blender</a>, <a href="https://www.autodesk.com/products/3ds-max/overview?term=1-YEAR&tab=subscription">3ds Max</a>, or <a href="https://www.autodesk.com/products/maya/overview?term=1-YEAR&tab=subscription">Maya</a>) allows meshes where the primitives are general polygons: quadriliterals, pentagons, heptagons, and so on. Each polygon in a mesh is called a <b>face</b>. We will follow this nomenclature and call a triangle in a mesh a face too. A <b>face normal vector</b> is just a normal vector to a face.</p> 

    <h3>6.2.1 &nbsp; The normal vector to a triangle</h3>

    <p>When we specify a triangle, say $ABC$, we need to list its corner points in some order. Here, $A$ denotes the first corner, $B$ the second, and $C$ the third.</p>

    <p>
    <div class="bg-light" style="padding: 20px">
        <p>
        <b>Example 6.1</b>
        For example, in the triangle mesh of Section 5.4.1, the $ABC$s of the two triangles are as follows:
        </p>
        <ul>
            <li>Triangle #1
                <ul>
                    <li>$A = $ Vertex #0 $= (0,0,0)$.</li>
                    <li>$B = $ Vertex #1 $= (1,0,0)$.</li>
                    <li>$C = $ Vertex #2 $= (1,1,0)$.</li>
                </ul>
            </li>
            <li>Triangle #2
                <ul>
                    <li>$A = $ Vertex #0 $= (0,0,0)$.</li>
                    <li>$B = $ Vertex #2 $= (1,1,0)$.</li>
                    <li>$C = $ Vertex #3 $= (0,1,0)$.</li>
                </ul>            
            </li>
        </ul>
    </div>
    </p>

    <p>We know from Section 3.7.5 that the vector
    \begin{align*}
    \widetilde{\ve{n}} = (B - A) \times (C - A)
    \end{align*}
    is a vector that is perpendicalar to the triangle. Dividing the vector by its length, we have that
    \begin{align*}
    \widehat{\ve{n}} = \frac{\widetilde{\ve{n}}}{\| \widetilde{\ve{n}} \|} = \frac{(B - A) \times (C - A)}{ \| (B-A) \times (C-A) \|}
    \end{align*}
    is a unit vector that is perpendicular to the triangle. However, we also know that
    \begin{align*}
    -\widehat{\ve{n}} = -\frac{(B - A) \times (C - A)}{ \| (B-A) \times (C-A) \|} = \frac{(C - A) \times (B - A)}{ \| (C-A) \times (B-A) \|}  
    \end{align*}
    is another unit vector that is perpedicular to the triangle. Between $\widehat{\ve{n}}$ and $-\widehat{\ve{n}}$, which one we should pick as the normal vector of the triangle then?
    </p>

    <p>In this book, we shall follow the convention is that the normal vector of triangle $ABC$, denoted by $\ve{n}$, is given by
    \begin{align*}
    \ve{n} = \widehat{\ve{n}} = \frac{\widetilde{\ve{n}}}{\| \widetilde{\ve{n}} \|} = \frac{(B - A) \times (C - A)}{ \| (B-A) \times (C-A) \|}.
    \end{align*}
    </p>

    <p>
    <div class="bg-light" style="padding: 20px">
        <p><b>Example 6.2</b> The normal vectors of the triangles of the mesh in Section 5.4.1 are as follows.
        \begin{align*}
        \mbox{Normal of Triangle #1}
        &=  \frac{  \left( \begin{bmatrix}1 \\ 0 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) \times \left( \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) }{\left\| \left( \begin{bmatrix}1 \\ 0 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) \times \left( \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) \right\|} \\
        &= \frac{  \begin{bmatrix}1 \\ 0 \\ 0\end{bmatrix}  \times \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} }{\left\| \begin{bmatrix}1 \\ 0 \\ 0\end{bmatrix} \times \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} \right\|} 
        = \frac{  \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}   }{\left\| \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}   \right\|} 
        = \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}. \\
        \mbox{Normal of Triangle #2}
        &=  
        \frac{  
            \left( \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) 
            \times 
            \left( \begin{bmatrix}0 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) 
        }
        {
            \left\| \left( \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) 
            \times 
            \left( \begin{bmatrix}0 \\ 1 \\ 0\end{bmatrix} - \begin{bmatrix}0 \\ 0 \\ 0\end{bmatrix} \right) \right\|
        } \\
        &= \frac{  
            \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix}  
            \times 
            \begin{bmatrix}0 \\ 1 \\ 0\end{bmatrix} 
        }
        {
            \left\| 
            \begin{bmatrix}1 \\ 1 \\ 0\end{bmatrix} 
            \times 
            \begin{bmatrix}0 \\ 1 \\ 0\end{bmatrix}
            \right\|
        } 
        = \frac{  
            \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}   
        }{
            \left\| \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}   \right\|
        } 
        = \begin{bmatrix}0 \\ 0 \\ 1\end{bmatrix}.
        \end{align*}
        The normal vectors are the same. This is good because these two triangles are used to form a square, another flat surface. The square should have one normal vector rather than two. 
        </p>
    </div>
    </p>

    <p>A consequence of basing the normal vector $\ve{n}$ on $(B-A) \times (C-A)$ rather than other calculation is that <b>one can determine the direction of the normal vector by looking at how the triangle's corners "swirl."</b></p>

    <p>This is the because the direction of $(B - A) \times (C - A)$ is determined by the right-hand rule. Recall from Figure 3.19 that the direction of $(B - A) \times (C - A)$ depends on the rotation to get from $B-A$ to $C-A$. If the rotation is counterclockwise when we look at it, the cross production points towards us. If the rotation is clockwise, then the cross product points away from us.</p>

    <p>Equivalently, we can trace the corners of the triangles in the specified order: from $A$ to $B$ to $C$ and then back to $A$ again. If the we see that the motion is a counterclockwise "swirling," then the triangle's normal vector would point towards us, and we are seeing the front side of the triangle. On the other hand, if the swirling is clockwise, the normal vector points away from us, and we are seeing the back side of the triangle.</p>

    <figure class="figure">
      <table>
        <tr>
          <td>
            <div style="border: 1px solid;">
            <a href="images/triangle-normal-ccw-00.png"><img src="images/triangle-normal-ccw-00.png" width="200"></a>
            </div>
          </td>
          <td>
            <div style="border: 1px solid;">
            <a href="images/triangle-normal-ccw-01.png"><img src="images/triangle-normal-ccw-01.png" width="200"></a>
            </div>
          </td>
          <td>
            <div style="border: 1px solid;">      
            <a href="images/triangle-normal-ccw-02.png"><img src="images/triangle-normal-ccw-02.png" width="200"></a>
            </div>
          </td>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td align="center">(b)</td>
          <td align="center">(c)</td>
        </tr>
        <tr>
          <td>
            <div style="border: 1px solid;">
            <a href="images/triangle-normal-cw-00.png"><img src="images/triangle-normal-cw-00.png" width="200"></a>
            </div>
          </td>
          <td>
            <div style="border: 1px solid;">
            <a href="images/triangle-normal-cw-01.png"><img src="images/triangle-normal-cw-01.png" width="200"></a>
            </div>
          </td>
          <td>
            <div style="border: 1px solid;">      
            <a href="images/triangle-normal-cw-02.png"><img src="images/triangle-normal-cw-02.png" width="200"></a>
            </div>
          </td>
        </tr>
        <tr>
          <td align="center">(d)</td>
          <td align="center">(e)</td>
          <td align="center">(f)</td>
        </tr>
      </table>
      <figcaption class="figure-caption"><strong>Figure 6.12</strong> When specifying a triangle, the order of the vertices determines the direction of the normal vector. In (a), the triangle $ABC$ lies in the $xy$-plane. We see that the vertices swirl in the counterclockwise direction as shown in (b). As a result, the normal vector points towards us, the viewer, along the $z$-axis as shown in (c). In (d), we have the same triangle, but the vertex $B$ swaps place with vertex $C$. Now, the vertices sway in the clockwise direction as shown in (e). Now, the normal vector points away from us in the $-z$ direction as shown in (f).</figcaption>
    </figure> 


    <h3>6.2.2 &nbsp; Consistency of face normals</h3>

    <p>In Section 6.2.1, we consider the normal vector of a single triangle, which is determined by the order in which its corners are specified. When a triangle is a part of a mesh, the order of corners is determined by the order of the vertex indices in the index buffer. So, <b>the order of vertex indices in the index buffer determines the direction of the normal vectors and the orientation of the faces</b>.</p>

    <p>There are as many normal vectors to a triangle mesh as there are faces. We want the face normals to be consistent to one another. The notion of consistency in question is inpired by the consitency of normal vectors in an orientation of a regular surface. It should be that, as we travel along the surface the normal vectors should not change abrubtly. To put it in another way, if we are a small creature standing on the front side of a mesh's face, we should not suddenly be on the back side if we walk to an adjacent face.</p>

    <p>The above notion of consistency requires that the orders of vertex indices of the triangles be consistent with one another. More specifically, all triangles should swirl in the same way. If the vertices of a triangle swirl counterclockwisely, the vertices of all the other triangles should also do so.</p>    

    <h2>6.3 &nbsp; Vertex normals</h2>

    <hr>
    <div class="footnotes">
      <ol> 
        <li class="footnote" id="fn:regular-surface-definition">
          <p>A mathematically inclined reader can consult standard textbooks on differential geometry such Manfredo P. do Carmo's <a href="https://www.amazon.co.jp/Differential-Geometry-Curves-Surfaces-Mathematics/dp/0486806995">Differential Geometry of Curves and Surfaces</a> for a rigorous definition of regular surfaces.</p>
        </li>               
      </ol>
    </div>

    
    <hr>
    <p>
      <a href="../chapter-05/index.html"><<</a>
      <a href="../index.html">Contents</a>      
    </p>
  </div>
  <script src="../js/bootstrap.bundle.min.js"></script>
  <script src="../js/littlefoot.js" type="application/javascript"></script>
  <script type="application/javascript">
    const { littlefoot } = require('littlefoot')

    const lf = littlefoot({
      activateOnHover: true,
      hoverDelay: 250,
    });
  </script>
</body>

</html>